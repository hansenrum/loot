(function(){"use strict";"todomvc.com"===location.hostname&&function(t,e){var n=t.createElement(e),r=t.getElementsByTagName(e)[0];n.src="//www.google-analytics.com/ga.js",r.parentNode.insertBefore(n,r)}(document,"script")})(window),function(window,$,undefined){var can=window.can||{};("undefined"==typeof GLOBALCAN||GLOBALCAN!==!1)&&(window.can=can),can.isDeferred=function(t){var e=this.isFunction;return t&&e(t.then)&&e(t.pipe)},can.each=function(t,e,n){var r,a=0;if(t)if("number"==typeof t.length&&t.pop)for(t.attr&&t.attr("length"),r=t.length;r>a&&e.call(n||t[a],t[a],a,t)!==!1;a++);else if(t.hasOwnProperty)for(r in t)if(t.hasOwnProperty(r)&&e.call(n||t[r],t[r],r,t)===!1)break;return t},$.extend(can,$,{trigger:function(t,e,n){t.trigger?t.trigger(e,n):$.event.trigger(e,n,t,!0)},addEvent:function(t,e){return $([this]).bind(t,e),this},removeEvent:function(t,e){return $([this]).unbind(t,e),this},buildFragment:function(t,e){var n=$.buildFragment([t],$(e));return n.cacheable?$.clone(n.fragment):n.fragment},$:$,each:can.each}),$.each(["bind","unbind","undelegate","delegate"],function(t,e){can[e]=function(){var t=this[e]?this:$([this]);return t[e].apply(t,arguments),this}}),$.each(["append","filter","addClass","remove","data","get"],function(t,e){can[e]=function(t){return t[e].apply(t,can.makeArray(arguments).slice(1))}});var oldClean=$.cleanData;$.cleanData=function(t){$.each(t,function(t,e){e&&can.trigger(e,"destroyed",[],!1)}),oldClean(t)};var undHash=/_|-/,colons=/\=\=/,words=/([A-Z]+)([A-Z][a-z])/g,lowUp=/([a-z\d])([A-Z])/g,dash=/([a-z\d])([A-Z])/g,replacer=/\{([^\}]+)\}/g,quote=/"/g,singleQuote=/'/g,getNext=function(t,e,n){return e in t?t[e]:n&&(t[e]={})},isContainer=function(t){return/^f|^o/.test(typeof t)};can.extend(can,{esc:function(t){var e=null===t||t===undefined||isNaN(t)&&"NaN"==""+t;return(""+(e?"":t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(quote,"&#34;").replace(singleQuote,"&#39;")},getObject:function(t,e,n){var r,a,i,s=t?t.split("."):[],c=s.length,o=0;if(e=can.isArray(e)?e:[e||window],!c)return e[0];for(;e[o];){for(r=e[o],i=0;c-1>i&&isContainer(r);i++)r=getNext(r,s[i],n);if(isContainer(r)&&(a=getNext(r,s[i],n),a!==undefined))return n===!1&&delete r[s[i]],a;o++}},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},underscore:function(t){return t.replace(colons,"/").replace(words,"$1_$2").replace(lowUp,"$1_$2").replace(dash,"_").toLowerCase()},sub:function(t,e,n){var r=[];return r.push(t.replace(replacer,function(t,a){var i=can.getObject(a,e,n===undefined?n:!n);return i===undefined?(r=null,""):isContainer(i)&&r?(r.push(i),""):""+i})),null===r?r:1>=r.length?r[0]:r},replacer:replacer,undHash:undHash});var initializing=0;can.Construct=function(){return arguments.length?can.Construct.extend.apply(can.Construct,arguments):undefined},can.extend(can.Construct,{newInstance:function(){var t,e=this.instance();return e.setup&&(t=e.setup.apply(e,arguments)),e.init&&e.init.apply(e,t||arguments),e},_inherit:function(t,e,n){can.extend(n||t,t||{})},_overwrite:function(t,e,n,r){t[n]=r},setup:function(t){this.defaults=can.extend(!0,{},t.defaults,this.defaults)},instance:function(){initializing=1;var t=new this;return initializing=0,t},extend:function(t,e,n){function r(){return initializing?undefined:this.constructor!==r&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.constructor.newInstance.apply(this.constructor,arguments)}"string"!=typeof t&&(n=e,e=t,t=null),n||(n=e,e=null),n=n||{};var a,i,s,c,o=this,u=this.prototype;c=this.instance(),can.Construct._inherit(n,u,c);for(a in o)o.hasOwnProperty(a)&&(r[a]=o[a]);if(can.Construct._inherit(e,o,r),t){var h=t.split("."),i=h.pop(),l=can.getObject(h.join("."),window,!0),s=l,d=can.underscore(t.replace(/\./g,"_")),p=can.underscore(i);l[i]=r}can.extend(r,{constructor:r,prototype:c,namespace:s,shortName:i,_shortName:p,fullName:t,_fullName:d}),r.prototype.constructor=r;var f=[o].concat(can.makeArray(arguments)),_=r.setup.apply(r,f);return r.init&&r.init.apply(r,_||f),r}});var canMakeObserve=function(t){return t&&(can.isArray(t)||can.isPlainObject(t)||t instanceof can.Observe)},unhookup=function(t,e){return can.each(t,function(t){t&&t.unbind&&t.unbind("change"+e)})},hookupBubble=function(t,e,n,r,a){return r=r||Observe,a=a||Observe.List,t instanceof Observe?unhookup([t],n._cid):t=can.isArray(t)?new a(t):new r(t),t.bind("change"+n._cid,function(){var r=can.makeArray(arguments),a=r.shift();r[0]=("*"===e?[n.indexOf(t),r[0]]:[e,r[0]]).join("."),a.triggeredNS=a.triggeredNS||{},a.triggeredNS[n._cid]||(a.triggeredNS[n._cid]=!0,can.trigger(n,a,r))}),t},observeId=0,serialize=function(t,e,n){return t.each(function(t,r){n[r]=canMakeObserve(t)&&can.isFunction(t[e])?t[e]():t}),n},$method=function(t){return function(){return can[t].apply(this,arguments)}},bind=$method("addEvent"),unbind=$method("removeEvent"),attrParts=function(t){return can.isArray(t)?t:(""+t).split(".")},batchNum=1,transactions=0,batchEvents=[],stopCallbacks=[],cid=0;can.cid=function(t,e){return t._cid?t._cid:t._cid=(e||"")+ ++cid};var Observe=can.Observe=can.Construct({bind:bind,unbind:unbind,id:"id",canMakeObserve:canMakeObserve,startBatch:function(t){transactions++,t&&stopCallbacks.push(t)},stopBatch:function(t,e){if(t?transactions=0:transactions--,0==transactions){var n=batchEvents.slice(0),r=stopCallbacks.slice(0);batchEvents=[],stopCallbacks=[],batchNum++,e&&this.startBatch(),can.each(n,function(t){can.trigger.apply(can,t)}),can.each(r,function(t){})}},triggerBatch:function(t,e,n){if(!t._init){if(0==transactions)return can.trigger(t,e,n);batchEvents.push([t,{type:e,batchNum:batchNum},n])}},keys:function(t){var e=[];Observe.__reading&&Observe.__reading(t,"__keys");for(var n in t._data)e.push(n);return e}},{setup:function(t){this._data={},can.cid(this,".observe"),this._init=1,this.attr(t),this.bind("change"+this._cid,can.proxy(this._changes,this)),delete this._init},_changes:function(t,e,n,r,a){Observe.triggerBatch(this,{type:e,batchNum:t.batchNum},[r,a])},attr:function(t,e){var n=typeof t;return"string"!==n&&"number"!==n?this._attrs(t,e):e===undefined?(Observe.__reading&&Observe.__reading(this,t),this._get(t)):(this._set(t,e),this)},each:function(){return Observe.__reading&&Observe.__reading(this,"__keys"),can.each.apply(undefined,[this.__get()].concat(can.makeArray(arguments)))},removeAttr:function(t){var e=attrParts(t),n=e.shift(),r=this._data[n];return e.length?r.removeAttr(e):(n in this._data&&(delete this._data[n],n in this.constructor.prototype||delete this[n],Observe.triggerBatch(this,"__keys",undefined),Observe.triggerBatch(this,"change",[n,"remove",undefined,r]),Observe.triggerBatch(this,n,[undefined,r])),r)},_get:function(t){var e=attrParts(t),n=this.__get(e.shift());return e.length?n?n._get(e):undefined:n},__get:function(t){return t?this._data[t]:this._data},_set:function(t,e){var n=attrParts(t),r=n.shift(),a=this.__get(r);if(canMakeObserve(a)&&n.length)a._set(n,e);else{if(n.length)throw"can.Observe: Object does not exist";this.__convert&&(e=this.__convert(r,e)),a||Observe.triggerBatch(this,"__keys",undefined),this.__set(r,e,a)}},__set:function(t,e,n){if(e!==n){var r=this.__get().hasOwnProperty(t)?"set":"add";this.___set(t,canMakeObserve(e)?hookupBubble(e,t,this):e),Observe.triggerBatch(this,"change",[t,r,e,n]),n&&unhookup([n],this._cid)}},___set:function(t,e){this._data[t]=e,t in this.constructor.prototype||(this[t]=e)},bind:bind,unbind:unbind,serialize:function(){return serialize(this,"serialize",{})},_attrs:function(t,e){if(t===undefined)return serialize(this,"attr",{});t=can.extend(!0,{},t);var n,r,a=this;Observe.startBatch(),this.each(function(n,i,s){return r=t[i],r===undefined?(e&&a.removeAttr(i),undefined):(a.__convert&&(r=a.__convert(i,r)),n!==r&&(n instanceof can.Observe&&r instanceof can.Observe&&unhookup([n],a._cid),r instanceof can.Observe?a._set(i,r):canMakeObserve(n)&&canMakeObserve(r)?n.attr(r,s):n!=r&&a._set(i,r)),delete t[i],undefined)});for(var n in t)r=t[n],this._set(n,r);return Observe.stopBatch(),this}}),splice=[].splice,list=Observe({setup:function(t,e){this.length=0,can.cid(this,".observe"),this._init=1,this.push.apply(this,can.makeArray(t||[])),this.bind("change"+this._cid,can.proxy(this._changes,this)),can.extend(this,e),delete this._init},_changes:function(t,e,n,r,a){~e.indexOf(".")||("add"===n?(Observe.triggerBatch(this,n,[r,+e]),Observe.triggerBatch(this,"length",[this.length])):"remove"===n?(Observe.triggerBatch(this,n,[a,+e]),Observe.triggerBatch(this,"length",[this.length])):Observe.triggerBatch(this,n,[r,+e])),Observe.prototype._changes.apply(this,arguments)},__get:function(t){return t?this[t]:this},___set:function(t,e){this[t]=e,+t>=this.length&&(this.length=+t+1)},serialize:function(){return serialize(this,"serialize",[])},splice:function(t,e){var n,r=can.makeArray(arguments);for(n=2;r.length>n;n++){var a=r[n];canMakeObserve(a)&&(r[n]=hookupBubble(a,"*",this))}e===undefined&&(e=r[1]=this.length-t);var i=splice.apply(this,r);return e>0&&(Observe.triggerBatch(this,"change",[""+t,"remove",undefined,i]),unhookup(i,this._cid)),r.length>2&&Observe.triggerBatch(this,"change",[""+t,"add",r.slice(2),i]),i},_attrs:function(t,e){return t===undefined?serialize(this,"attr",[]):(t=can.makeArray(t),Observe.startBatch(),this._updateAttrs(t,e),Observe.stopBatch(),undefined)},_updateAttrs:function(t,e){for(var n=Math.min(t.length,this.length),r=0;n>r;r++){var a=this[r],i=t[r];canMakeObserve(a)&&canMakeObserve(i)?a.attr(i,e):a!=i&&this._set(r,i)}t.length>this.length?this.push.apply(this,t.slice(this.length)):t.length<this.length&&e&&this.splice(t.length)}}),getArgs=function(t){return t[0]&&can.isArray(t[0])?t[0]:can.makeArray(t)};can.each({push:"length",unshift:0},function(t,e){list.prototype[e]=function(){for(var n=can.makeArray(arguments),r=t?this.length:0,a=0;n.length>a;a++){var i=n[a];canMakeObserve(i)&&(n[a]=hookupBubble(i,"*",this,this.constructor.Observe,this.constructor))}var s=[][e].apply(this,n);return this.comparator&&n.length||Observe.triggerBatch(this,"change",[""+r,"add",n,undefined]),s}}),can.each({pop:"length",shift:0},function(t,e){list.prototype[e]=function(){var n=getArgs(arguments),r=t&&this.length?this.length-1:0,a=[][e].apply(this,n);return Observe.triggerBatch(this,"change",[""+r,"remove",undefined,[a]]),a&&a.unbind&&a.unbind("change"+this._cid),a}}),can.extend(list.prototype,{indexOf:function(t){return this.attr("length"),can.inArray(t,this)},join:[].join,slice:function(){var t=Array.prototype.slice.apply(this,arguments);return new this.constructor(t)},concat:function(){var t=[];return can.each(can.makeArray(arguments),function(e,n){t[n]=e instanceof can.Observe.List?e.serialize():e}),new this.constructor(Array.prototype.concat.apply(this.serialize(),t))},forEach:function(t,e){can.each(this,t,e||this)}}),Observe.List=list,Observe.setup=function(){can.Construct.setup.apply(this,arguments),this.List=Observe.List({Observe:this},{})};var pipe=function(t,e,n){var r=new can.Deferred;return t.then(function(){var t=can.makeArray(arguments);t[0]=e[n](t[0]),r.resolveWith(r,t)},function(){r.rejectWith(this,arguments)}),"function"==typeof t.abort&&(r.abort=function(){return t.abort()}),r},modelNum=0,ignoreHookup=/change.observe\d+/,getId=function(t){return can.Observe.__reading&&can.Observe.__reading(t,t.constructor.id),t.__get(t.constructor.id)},ajax=function(t,e,n,r,a,i){var s={};if("string"==typeof t){var c=t.split(/\s/);s.url=c.pop(),c.length&&(s.type=c.pop())}else can.extend(s,t);return s.data="object"!=typeof e||can.isArray(e)?e:can.extend(s.data||{},e),s.url=can.sub(s.url,s.data,!0),can.ajax(can.extend({type:n||"post",dataType:r||"json",success:a,error:i},s))},makeRequest=function(t,e,n,r,a){var i,s,c=[t.serialize()],o=t.constructor;return"destroy"==e&&c.shift(),"create"!==e&&c.unshift(getId(t)),s=o[e].apply(o,c),i=s.pipe(function(n){return t[a||e+"d"](n,s),t}),s.abort&&(i.abort=function(){s.abort()}),i.then(n,r),i},ajaxMethods={create:{url:"_shortName",type:"post"},update:{data:function(t,e){e=e||{};var n=this.id;return e[n]&&e[n]!==t&&(e["new"+can.capitalize(t)]=e[n],delete e[n]),e[n]=t,e},type:"put"},destroy:{type:"delete",data:function(t){var e={};return e.id=e[this.id]=t,e}},findAll:{url:"_shortName"},findOne:{}},ajaxMaker=function(t,e){return function(n){return n=t.data?t.data.apply(this,arguments):n,ajax(e||this[t.url||"_url"],n,t.type||"get")}};can.Model=can.Observe({fullName:"can.Model",setup:function(t){if(this.store={},can.Observe.setup.apply(this,arguments),can.Model){this.List=ML({Observe:this},{});var e=this,n=can.proxy(this._clean,e);can.each(ajaxMethods,function(r,a){if(can.isFunction(e[a])||(e[a]=ajaxMaker(r,e[a])),e["make"+can.capitalize(a)]){var i=e["make"+can.capitalize(a)](e[a]);can.Construct._overwrite(e,t,a,function(){this._reqs++;var t=i.apply(this,arguments),e=t.then(n,n);return e.abort=t.abort,e})}}),"can.Model"!=e.fullName&&e.fullName||(e.fullName="Model"+ ++modelNum),this._reqs=0,this._url=this._shortName+"/{"+this.id+"}"}},_ajax:ajaxMaker,_clean:function(){if(this._reqs--,!this._reqs)for(var t in this.store)this.store[t]._bindings||delete this.store[t];return arguments[0]},models:function(t,e){if(t){if(t instanceof this.List)return t;var n=this,r=[],a=e instanceof can.Observe.List?e:new(n.List||ML),i=can.isArray(t),s=t instanceof ML,c=i?t:s?t.serialize():t.data;return a.length>0&&a.splice(0),can.each(c,function(t){r.push(n.model(t))}),a.push.apply(a,r),i||can.each(t,function(t,e){"data"!==e&&a.attr(e,t)}),a}},model:function(t){if(t){t instanceof this&&(t=t.serialize());var e=t[this.id],n=e&&this.store[e]?this.store[e].attr(t):new this(t);return this._reqs&&(this.store[t[this.id]]=n),n}}},{isNew:function(){var t=getId(this);return!(t||0===t)},save:function(t,e){return makeRequest(this,this.isNew()?"create":"update",t,e)},destroy:function(t,e){return makeRequest(this,"destroy",t,e,"destroyed")},bind:function(t){return ignoreHookup.test(t)||(this._bindings||(this.constructor.store[getId(this)]=this,this._bindings=0),this._bindings++),can.Observe.prototype.bind.apply(this,arguments)},unbind:function(t){return ignoreHookup.test(t)||(this._bindings--,this._bindings||delete this.constructor.store[getId(this)]),can.Observe.prototype.unbind.apply(this,arguments)},___set:function(t,e){can.Observe.prototype.___set.call(this,t,e),t===this.constructor.id&&this._bindings&&(this.constructor.store[getId(this)]=this)}}),can.each({makeFindAll:"models",makeFindOne:"model"},function(t,e){can.Model[e]=function(e){return function(n,r,a){var i=pipe(e.call(this,n),this,t);return i.then(r,a),i}}}),can.each(["created","updated","destroyed"],function(t){can.Model.prototype[t]=function(e){var n,r=this.constructor;n=e&&"object"==typeof e&&this.attr(e.attr?e.attr():e),can.trigger(this,t),can.trigger(this,"change",t),can.trigger(r,t,this)}});var ML=can.Model.List=can.Observe.List({setup:function(){can.Observe.List.prototype.setup.apply(this,arguments);var t=this;this.bind("change",function(e,n){if(/\w+\.destroyed/.test(n)){var r=t.indexOf(e.target);-1!=r&&t.splice(r,1)}})}}),digitTest=/^\d+$/,keyBreaker=/([^\[\]]+)|(\[\])/g,paramTest=/([^?#]*)(#.*)?$/,prep=function(t){return decodeURIComponent(t.replace(/\+/g," "))};can.extend(can,{deparam:function(t){var e,n,r={};return t&&paramTest.test(t)&&(e=t.split("&"),can.each(e,function(t){var e=t.split("="),a=prep(e.shift()),i=prep(e.join("=")),s=r;e=a.match(keyBreaker);for(var c=0,o=e.length-1;o>c;c++)s[e[c]]||(s[e[c]]=digitTest.test(e[c+1])||"[]"==e[c+1]?[]:{}),s=s[e[c]];n=e.pop(),"[]"==n?s.push(i):s[n]=i})),r}});var matcher=/\:([\w\.]+)/g,paramsMatcher=/^(?:&[^=]+=[^&]*)+/,makeProps=function(t){var e=[];return can.each(t,function(t,n){e.push(("className"===n?"class":n)+'="'+("href"===n?t:can.esc(t))+'"')}),e.join(" ")},matchesData=function(t,e){var n=0,r=0,a={};for(var i in t.defaults)t.defaults[i]===e[i]&&(a[i]=1,n++);for(;t.names.length>r;r++){if(!e.hasOwnProperty(t.names[r]))return-1;a[t.names[r]]||n++}return n},onready=!0,location=window.location,wrapQuote=function(t){return(t+"").replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},each=can.each,extend=can.extend;can.route=function(t,e){e=e||{};var n=[],r=t.replace(matcher,function(r,a,i){n.push(a);var s="\\"+(t.substr(i+r.length,1)||can.route._querySeparator);return"([^"+s+"]"+(e[a]?"*":"+")+")"});return can.route.routes[t]={test:RegExp("^"+r+"($|"+wrapQuote(can.route._querySeparator)+")"),route:t,names:n,defaults:e,length:t.split("/").length},can.route},extend(can.route,{_querySeparator:"&",_paramsMatcher:paramsMatcher,param:function(t,e){var n,r,a=0,i=t.route,s=0;if(delete t.route,each(t,function(){s++}),each(can.route.routes,function(e){return r=matchesData(e,t),r>a&&(n=e,a=r),r>=s?!1:undefined}),can.route.routes[i]&&matchesData(can.route.routes[i],t)===a&&(n=can.route.routes[i]),n){var c,o=extend({},t),u=n.route.replace(matcher,function(e,r){return delete o[r],t[r]===n.defaults[r]?"":encodeURIComponent(t[r])});return each(n.defaults,function(t,e){o[e]===t&&delete o[e]}),c=can.param(o),e&&can.route.attr("route",n.route),u+(c?can.route._querySeparator+c:"")}return can.isEmptyObject(t)?"":can.route._querySeparator+can.param(t)},deparam:function(t){var e={length:-1};if(each(can.route.routes,function(n){n.test.test(t)&&n.length>e.length&&(e=n)}),e.length>-1){var n=t.match(e.test),r=n.shift(),a=t.substr(r.length-(n[n.length-1]===can.route._querySeparator?1:0)),i=a&&can.route._paramsMatcher.test(a)?can.deparam(a.slice(1)):{};return i=extend(!0,{},e.defaults,i),each(n,function(t,n){t&&t!==can.route._querySeparator&&(i[e.names[n]]=decodeURIComponent(t))}),i.route=e.route,i}return t.charAt(0)!==can.route._querySeparator&&(t=can.route._querySeparator+t),can.route._paramsMatcher.test(t)?can.deparam(t.slice(1)):{}},data:new can.Observe({}),routes:{},ready:function(t){return t===!1&&(onready=t),(t===!0||onready===!0)&&(can.route._setup(),setState()),can.route},url:function(t,e){return e&&(t=extend({},curParams,t)),"#!"+can.route.param(t)},link:function(t,e,n,r){return"<a "+makeProps(extend({href:can.route.url(e,r)},n))+">"+t+"</a>"},current:function(t){return location.hash=="#!"+can.route.param(t)},_setup:function(){can.bind.call(window,"hashchange",setState)},_getHash:function(){return location.href.split(/#!?/)[1]||""},_setHash:function(t){var e=can.route.param(t,!0);return location.hash="#!"+e,e}}),each(["bind","unbind","delegate","undelegate","attr","removeAttr"],function(t){can.route[t]=function(){return can.route.data[t].apply(can.route.data,arguments)}});var timer,curParams,setState=can.route.setState=function(){var t=can.route._getHash();curParams=can.route.deparam(t),changingData&&t===lastHash||can.route.attr(curParams,!0)},lastHash,changingData;can.route.bind("change",function(){changingData=1,clearTimeout(timer),timer=setTimeout(function(){changingData=0;var t=can.route.data.serialize();lastHash=can.route._setHash(t)},1)}),can.bind.call(document,"ready",can.route.ready),can.route.constructor.canMakeObserve=can.Observe.canMakeObserve;var bind=function(t,e,n){return can.bind.call(t,e,n),function(){can.unbind.call(t,e,n)}},isFunction=can.isFunction,extend=can.extend,each=can.each,slice=[].slice,paramReplacer=/\{([^\}]+)\}/g,special=can.getObject("$.event.special")||{},delegate=function(t,e,n,r){return can.delegate.call(t,e,n,r),function(){can.undelegate.call(t,e,n,r)}},binder=function(t,e,n,r){return r?delegate(t,can.trim(r),e,n):bind(t,e,n)},basicProcessor,Control=can.Control=can.Construct({setup:function(){if(can.Construct.setup.apply(this,arguments),can.Control){var t,e=this;e.actions={};for(t in e.prototype)e._isAction(t)&&(e.actions[t]=e._action(t))}},_shifter:function(t,e){var n="string"==typeof e?t[e]:e;return isFunction(n)||(n=t[n]),function(){return t.called=e,n.apply(t,[this.nodeName?can.$(this):this].concat(slice.call(arguments,0)))}},_isAction:function(t){var e=this.prototype[t],n=typeof e;return"constructor"!==t&&("function"==n||"string"==n&&isFunction(this.prototype[e]))&&!!(special[t]||processors[t]||/[^\w]/.test(t))},_action:function(t,e){if(paramReplacer.lastIndex=0,e||!paramReplacer.test(t)){var n=e?can.sub(t,[e,window]):t;if(!n)return null;var r=can.isArray(n),a=r?n[1]:n,i=a.split(/\s+/g),s=i.pop();return{processor:processors[s]||basicProcessor,parts:[a,i.join(" "),s],delegate:r?n[0]:undefined}}},processors:{},defaults:{}},{setup:function(t,e){var n,r=this.constructor,a=r.pluginName||r._fullName;return this.element=can.$(t),a&&"can_control"!==a&&this.element.addClass(a),(n=can.data(this.element,"controls"))||can.data(this.element,"controls",n=[]),n.push(this),this.options=extend({},r.defaults,e),this.on(),[this.element,this.options]},on:function(t,e,n,r){if(!t){this.off();var a,i,s=this.constructor,c=this._bindings,o=s.actions,u=this.element,h=can.Control._shifter(this,"destroy");for(a in o)o.hasOwnProperty(a)&&(i=o[a]||s._action(a,this.options))&&c.push(i.processor(i.delegate||u,i.parts[2],i.parts[1],a,this));return can.bind.call(u,"destroyed",h),c.push(function(t){can.unbind.call(t,"destroyed",h)}),c.length}return"string"==typeof t&&(r=n,n=e,e=t,t=this.element),r===undefined&&(r=n,n=e,e=null),"string"==typeof r&&(r=can.Control._shifter(this,r)),this._bindings.push(binder(t,n,r,e)),this._bindings.length},off:function(){var t=this.element[0];each(this._bindings||[],function(e){e(t)}),this._bindings=[]},destroy:function(){var t,e=this.constructor,n=e.pluginName||e._fullName;this.off(),n&&"can_control"!==n&&this.element.removeClass(n),t=can.data(this.element,"controls"),t.splice(can.inArray(this,t),1),can.trigger(this,"destroyed"),this.element=null}}),processors=can.Control.processors,basicProcessor=function(t,e,n,r,a){return binder(t,e,can.Control._shifter(a,r),n)};each(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave"],function(t){processors[t]=basicProcessor}),can.Control.processors.route=function(t,e,n,r,a){n=n||"",can.route(n);var i,s=function(t){if(can.route.attr("route")===n&&(t.batchNum===undefined||t.batchNum!==i)){i=t.batchNum;var e=can.route.attr();delete e.route,can.isFunction(a[r])?a[r](e):a[a[r]](e)}};return can.route.bind("change",s),function(){can.route.unbind("change",s)}};var isFunction=can.isFunction,makeArray=can.makeArray,hookupId=1,$view=can.view=function(t,e,n,r){var a=$view.render(t,e,n,r);return isFunction(a)?a:can.isDeferred(a)?a.pipe(function(t){return $view.frag(t)}):$view.frag(a)};can.extend($view,{frag:function(t,e){return $view.hookup($view.fragment(t),e)},fragment:function(t){var e=can.buildFragment(t,document.body);return e.childNodes.length||e.appendChild(document.createTextNode("")),e},toId:function(t){return can.map((""+t).split(/\/|\./g),function(t){return t?t:undefined}).join("_")},hookup:function(t,e){var n,r,a=[];return can.each(t.childNodes?can.makeArray(t.childNodes):t,function(t){1===t.nodeType&&(a.push(t),a.push.apply(a,can.makeArray(t.getElementsByTagName("*"))))}),can.each(a,function(t){t.getAttribute&&(n=t.getAttribute("data-view-id"))&&(r=$view.hookups[n])&&(r(t,e,n),delete $view.hookups[n],t.removeAttribute("data-view-id"))}),t},hookups:{},hook:function(t){return $view.hookups[++hookupId]=t," data-view-id='"+hookupId+"'"},cached:{},cachedRenderers:{},cache:!0,register:function(t){this.types["."+t.suffix]=t},types:{},ext:".ejs",registerScript:function(){},preload:function(){},render:function(t,e,n,r){isFunction(n)&&(r=n,n=undefined);var a=getDeferreds(e);if(a.length){var i=new can.Deferred;return a.push(get(t,!0)),can.when.apply(can,a).then(function(t){var a,s=makeArray(arguments),c=s.pop();if(can.isDeferred(e))e=usefulPart(t);else for(var o in e)can.isDeferred(e[o])&&(e[o]=usefulPart(s.shift()));a=c(e,n),i.resolve(a),r&&r(a)}),i}var s,c=isFunction(r),i=get(t,c);if(c)s=i,i.then(function(t){r(e?t(e,n):t)});else{if("resolved"===i.state()&&i.__view_id){var o=$view.cachedRenderers[i.__view_id];return e?o(e,n):o}i.then(function(t){s=e?t(e,n):t})}return s},registerView:function(t,e,n,r){var a=(n||$view.types[$view.ext]).renderer(t,e);return r=r||new can.Deferred,$view.cache&&($view.cached[t]=r,r.__view_id=t,$view.cachedRenderers[t]=a),r.resolve(a)}});var checkText=function(t,e){if(!t.length)throw"can.view: No template or empty template:"+e},get=function(t,e){var n,r,a,i=t.match(/\.[\w\d]+$/);if(t.match(/^#/)&&(t=t.substr(1)),(r=document.getElementById(t))&&(i="."+r.type.match(/\/(x\-)?(.+)/)[2]),i||$view.cached[t]||(t+=i=$view.ext),can.isArray(i)&&(i=i[0]),a=$view.toId(t),t.match(/^\/\//)){var s=t.substr(2);t=window.steal?steal.config().root.mapJoin(s):s}if(n=$view.types[i],$view.cached[a])return $view.cached[a];if(r)return $view.registerView(a,r.innerHTML,n);var c=new can.Deferred;return can.ajax({async:e,url:t,dataType:"text",error:function(e){checkText("",t),c.reject(e)},success:function(e){checkText(e,t),$view.registerView(a,e,n,c)}}),c},getDeferreds=function(t){var e=[];if(can.isDeferred(t))return[t];for(var n in t)can.isDeferred(t[n])&&e.push(t[n]);return e},usefulPart=function(t){return can.isArray(t)&&"success"===t[1]?t[0]:t};window.steal&&steal.type("view js",function(t,e){var n=$view.types["."+t.type],r=$view.toId(t.id);t.text="steal('"+(n.plugin||"can/view/"+t.type)+"',function(can){return "+"can.view.preload('"+r+"',"+t.text+");\n})",e()}),can.extend($view,{register:function(t){this.types["."+t.suffix]=t,window.steal&&steal.type(t.suffix+" view js",function(t,e){var n=$view.types["."+t.type],r=$view.toId(t.id+"");t.text=n.script(r,t.text),e()}),$view[t.suffix]=function(e,n){return n?($view.preload(e,t.renderer(e,n)),can.view(e)):t.renderer(null,e)}},registerScript:function(t,e,n){return"can.view.preload('"+e+"',"+$view.types["."+t].script(e,n)+");"},preload:function(t,e){return $view.cached[t]=(new can.Deferred).resolve(function(t,n){return e.call(t,t,n)}),function(){return $view.frag(e.apply(this,arguments))}}});var getValueAndObserved=function(t,e){var n;can.Observe&&(n=can.Observe.__reading,can.Observe.__reading=function(t,e){r.push({obj:t,attr:e})});var r=[],a=t.call(e);return can.Observe&&(can.Observe.__reading=n),{value:a,observed:r}},computeBinder=function(t,e,n){var r,a={},i=!0,s={value:undefined,teardown:function(){for(var t in a){var e=a[t];e.observe.obj.unbind(e.observe.attr,c),delete a[t]}}},c=function(t){if(t.batchNum===undefined||t.batchNum!==r){var e=s.value,a=o();s.value=a,a!==e&&n(a,e),r=r=t.batchNum}},o=function(){var n=getValueAndObserved(t,e),r=n.observed,s=n.value;i=!i,can.each(r,function(t){a[t.obj._cid+"|"+t.attr]?a[t.obj._cid+"|"+t.attr].matched=i:(a[t.obj._cid+"|"+t.attr]={matched:i,observe:t},t.obj.bind(t.attr,c))});for(var o in a){var u=a[o];u.matched!==i&&(u.observe.obj.unbind(u.observe.attr,c),delete a[o])}return s};return s.value=o(),s.isListening=!can.isEmptyObject(a),s};can.compute=function(t,e){if(t&&t.isComputed)return t;var n,r,a=0,i=!0;return"function"==typeof t?r=function(i){return i===undefined?n?(a&&can.Observe.__reading&&can.Observe.__reading(r,"change"),n.value):t.call(e||this):t.apply(e||this,arguments)}:(r=function(e){if(e===undefined)return can.Observe.__reading&&can.Observe.__reading(r,"change"),t;var n=t;return t=e,n!==e&&can.Observe.triggerBatch(r,"change",[e,n]),e},i=!1),r.isComputed=!0,r.bind=function(){can.addEvent.apply(r,arguments),0===a&&i&&(n=computeBinder(t,e||this,function(t,e){can.Observe.triggerBatch(r,"change",[t,e])})),a++},r.unbind=function(){can.removeEvent.apply(r,arguments),a--,0===a&&i&&n.teardown()},r},can.compute.binder=computeBinder;var newLine=/(\r|\n)+/g,tagToContentPropMap={option:"textContent",textarea:"value"},clean=function(t){return t.split("\\").join("\\\\").split("\n").join("\\n").split('"').join('\\"').split("	").join("\\t")},reverseTagMap={tr:"tbody",option:"select",td:"tr",li:"ul"},getTag=function(t,e,n){if(t)return t;for(;e.length>n;){if("<"==e[n]&&reverseTagMap[e[n+1]])return reverseTagMap[e[n+1]];n++}},bracketNum=function(t){return--t.split("{").length- --t.split("}").length},myEval=function(script){eval(script)},attrReg=/([^\s]+)[\s]*=[\s]*$/,startTxt="var ___v1ew = [];",finishTxt="return ___v1ew.join('')",put_cmd="___v1ew.push(",insert_cmd=put_cmd,htmlTag=null,quote=null,beforeQuote=null,rescan=null,status=function(){return quote?"'"+beforeQuote.match(attrReg)[1]+"'":htmlTag?1:0};can.view.Scanner=Scanner=function(t){can.extend(this,{text:{},tokens:[]},t),this.tokenReg=[],this.tokenSimple={"<":"<",">":">",'"':'"',"'":"'"},this.tokenComplex=[],this.tokenMap={};for(var e,n=0;e=this.tokens[n];n++)e[2]?(this.tokenReg.push(e[2]),this.tokenComplex.push({abbr:e[1],re:RegExp(e[2]),rescan:e[3]})):(this.tokenReg.push(e[1]),this.tokenSimple[e[1]]=e[0]),this.tokenMap[e[0]]=e[1];this.tokenReg=RegExp("("+this.tokenReg.slice(0).concat(["<",">",'"',"'"]).join("|")+")","g")},Scanner.prototype={helpers:[{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(t){var e=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,n=t.match(e);return"function(__){var "+n[1]+"=can.$(__);"+n[2]+"}"}}],scan:function(t,e){var n=[],r=0,a=this.tokenSimple,i=this.tokenComplex;t=t.replace(newLine,"\n"),t.replace(this.tokenReg,function(e,s){var c=arguments[arguments.length-2];if(c>r&&n.push(t.substring(r,c)),a[e])n.push(e);else for(var o,u=0;o=i[u];u++)if(o.re.test(e)){n.push(o.abbr),o.rescan&&n.push(o.rescan(s));break}r=c+s.length}),t.length>r&&n.push(t.substr(r));var s,c,o,u="",h=[startTxt+(this.text.start||"")],l=function(t,e){h.push(put_cmd,'"',clean(t),'"'+(e||"")+");")},d=[],p=null,f=!1,_="",v=[],g=0,m=this.tokenMap;for(htmlTag=quote=beforeQuote=null;(o=n[g++])!==undefined;){if(null===p)switch(o){case m.left:case m.escapeLeft:case m.returnLeft:f=htmlTag&&1;case m.commentLeft:p=o,u.length&&l(u),u="";break;case m.escapeFull:f=htmlTag&&1,rescan=1,p=m.escapeLeft,u.length&&l(u),rescan=n[g++],u=rescan.content||rescan,rescan.before&&l(rescan.before),n.splice(g,0,m.right);break;case m.commentFull:break;case m.templateLeft:u+=m.left;break;case"<":0!==n[g].indexOf("!--")&&(htmlTag=1,f=0),u+=o;break;case">":htmlTag=0;var b="/"==u.substr(u.length-1);f||tagToContentPropMap[v[v.length-1]]?(b?l(u.substr(0,u.length-1),',can.view.pending(),"/>"'):l(u,',can.view.pending(),">"'),u=""):u+=o,b&&(v.pop(),_=v[v.length-1]);break;case"'":case'"':htmlTag&&(quote&&quote===o?quote=null:null===quote&&(quote=o,beforeQuote=s));default:"<"===s&&(_=o.split(/\s/)[0],0===_.indexOf("/")&&v.pop()===_.substr(1)?_=v[v.length-1]:v.push(_)),u+=o}else switch(o){case m.right:case m.returnRight:switch(p){case m.left:c=bracketNum(u),1==c?(h.push(insert_cmd,"can.view.txt(0,'"+getTag(_,n,g)+"',"+status()+",this,function(){",startTxt,u),d.push({before:"",after:finishTxt+"}));\n"})):(r=d.length&&-1==c?d.pop():{after:";"},r.before&&h.push(r.before),h.push(u,";",r.after));break;case m.escapeLeft:case m.returnLeft:c=bracketNum(u),c&&d.push({before:finishTxt,after:"}));"});for(var w=p===m.escapeLeft?1:0,y={insert:insert_cmd,tagName:_,status:status()},x=0;this.helpers.length>x;x++){var k=this.helpers[x];if(k.name.test(u)){u=k.fn(u,y),k.name.source==/^>[\s|\w]\w*/.source&&(w=0);break}}"object"==typeof u?u.raw&&h.push(u.raw):h.push(insert_cmd,"can.view.txt("+w+",'"+_+"',"+status()+",this,function(){ "+(this.text.escape||"")+"return ",u,c?startTxt:"}));"),rescan&&rescan.after&&rescan.after.length&&(l(rescan.after.length),rescan=null)}p=null,u="";break;case m.templateLeft:u+=m.left;break;default:u+=o}s=o}u.length&&l(u),h.push(";");var M=h.join(""),O={out:"with(_VIEW) { with (_CONTEXT) {"+M+" "+finishTxt+"}}"};return myEval.call(O,"this.fn = (function(_CONTEXT,_VIEW){"+O.out+"});\r\n//@ sourceURL="+e+".js"),O}};var canExpando=!0;try{document.createTextNode()._=0}catch(ex){canExpando=!1}var attrMap={"class":"className",value:"value",textContent:"textContent"},tagMap={"":"span",table:"tr",tr:"td",ol:"li",ul:"li",tbody:"tr",thead:"tr",tfoot:"tr",select:"option",optgroup:"option"},attributePlaceholder="__!!__",attributeReplace=/__!!__/g,tagToContentPropMap={option:"textContent",textarea:"value"},bool=can.each(["checked","disabled","readonly","required"],function(t){attrMap[t]=t
}),getParentNode=function(t,e){return e&&11===t.parentNode.nodeType?e:t.parentNode},setAttr=function(t,e,n){var r=(""+t.nodeName).toLowerCase(),a=attrMap[e];a?(t[a]=can.inArray(e,bool)>-1?!0:n,"value"===a&&"input"===r&&(t.defaultValue=n)):t.setAttribute(e,n)},getAttr=function(t,e){return(attrMap[e]?t[attrMap[e]]:t.getAttribute(e))||""},removeAttr=function(t,e){can.inArray(e,bool)>-1?t[e]=!1:t.removeAttribute(e)},pendingHookups=[],contentText=function(t){if("string"==typeof t)return t;if(!t&&0!==t)return"";var e=t.hookup&&function(e,n){t.hookup.call(t,e,n)}||"function"==typeof t&&t;return e?(pendingHookups.push(e),""):""+t},contentEscape=function(t){return"string"==typeof t||"number"==typeof t?can.esc(t):contentText(t)},nodeMap={},textNodeMap={},nodeListMap={},expando="ejs_"+Math.random(),_id=0,id=function(t){if(canExpando||3!==t.nodeType)return t[expando]?t[expando]:t[expando]=(t.nodeName?"element_":"obj_")+ ++_id;for(var e in textNodeMap)if(textNodeMap[e]===t)return e;return textNodeMap["text_"+ ++_id]=t,"text_"+_id},removeNodeListId=function(t,e){var n=nodeMap[id(t)];if(n){var r=can.inArray(e,n);r>=0&&n.splice(r,1),n.length||delete nodeMap[id(t)]}},addNodeListId=function(t,e){var n=nodeMap[id(t)];n||(n=nodeMap[id(t)]=[]),n.push(e)},tagChildren=function(t){var e=tagMap[t]||"span";return"span"===e?"@@!!@@":"<"+e+">"+tagChildren(e)+"</"+e+">"};can.extend(can.view,{pending:function(){var t=pendingHookups.slice(0);return lastHookups=t,pendingHookups=[],can.view.hook(function(e){can.each(t,function(t){t(e)})})},registerNode:function(t){var e=id(t);nodeListMap[e]=t,can.each(t,function(t){addNodeListId(t,e)})},unregisterNode:function(t){var e=id(t);can.each(t,function(t){removeNodeListId(t,e)}),delete nodeListMap[e]},txt:function(t,e,n,r,a){var i=can.compute.binder(a,r,function(t,e){o(t,e)});if(!i.isListening)return(t||0!==n?contentEscape:contentText)(i.value);var s,c,o,u=function(){i.teardown(),c&&can.view.unregisterNode(c)},h=function(t){can.bind.call(t,"destroyed",u),s=t},l=function(t){t||(u(),can.unbind.call(s,"destroyed",u))},d=tagMap[e]||"span",p=tagToContentPropMap[e];if(0!==n||p){if(1===n){var f=i.value.replace(/['"]/g,"").split("=")[0];return pendingHookups.push(function(t){o=function(e){var n=(e||"").replace(/['"]/g,"").split("="),r=n[0];r!=f&&f&&removeAttr(t,f),r&&(setAttr(t,r,n[1]),f=r)},h(t)}),i.value}var _=0===n?p:n;return(0===n?lastHookups:pendingHookups).push(function(t){o=function(){setAttr(t,_,r.render(),p)};var e,n=can.$(t);e=can.data(n,"hooks"),e||can.data(n,"hooks",e={});var r,a=getAttr(t,_,p),s=a.split(attributePlaceholder),c=[];c.push(s.shift(),s.join(attributePlaceholder)),e[_]?e[_].bindings.push(i):e[_]={render:function(){var t=0,e=a.replace(attributeReplace,function(){return contentText(r.bindings[t++].value)});return e},bindings:[i],batchNum:undefined},r=e[_],c.splice(1,0,i.value),setAttr(t,_,c.join(""),p),h(t)}),attributePlaceholder}return"<"+d+can.view.hook(t?function(t,e){o=function(t){r.nodeValue=""+t,l(r.parentNode)};var n=getParentNode(t,e),r=document.createTextNode(i.value);n.insertBefore(r,t),n.removeChild(t),h(n)}:function(t,e){o=function(t){var e=n[0].parentNode;e&&r(t),l(n[0].parentNode)},e=getParentNode(t,e);var n,r=function(r){var a=can.view.frag(r,e),i=can.makeArray(a.childNodes),s=n?n[n.length-1]:t;s.nextSibling?s.parentNode.insertBefore(a,s.nextSibling):s.parentNode.appendChild(a),n?(can.remove(can.$(n)),can.view.replace(n,i)):(can.remove(can.$(t)),n=i,c=n,can.view.registerNode(n))};r(i.value,[t]),h(e)})+">"+tagChildren(d)+"</"+d+">"},replace:function(t,e){t=can.makeArray(t),can.each(t,function(n){can.each(can.makeArray(nodeMap[id(n)]),function(r){var a=nodeListMap[r],i=can.inArray(n,a),s=can.inArray(t[t.length-1],a);if(i>=0&&s>=0){for(var c=i;s>=c;c++){var o=a[c];removeNodeListId(o,r)}a.splice.apply(a,[i,s-i+1].concat(e)),can.each(e,function(t){addNodeListId(t,r)})}else can.view.unregisterNode(a)})})},canExpando:canExpando,textNodeMap:textNodeMap,nodeMap:nodeMap,nodeListMap:nodeListMap});var extend=can.extend,EJS=function(t){if(this.constructor!=EJS){var e=new EJS(t);return function(t,n){return e.render(t,n)}}return"function"==typeof t?(this.template={fn:t},undefined):(extend(this,t),this.template=this.scanner.scan(this.text,this.name),undefined)};can.EJS=EJS,EJS.prototype.render=function(t,e){return t=t||{},this.template.fn.call(t,t,new EJS.Helpers(t,e||{}))},extend(EJS.prototype,{scanner:new can.view.Scanner({tokens:[["templateLeft","<%%"],["templateRight","%>"],["returnLeft","<%=="],["escapeLeft","<%="],["commentLeft","<%#"],["left","<%"],["right","%>"],["returnRight","%>"]]})}),EJS.Helpers=function(t,e){this._data=t,this._extras=e,extend(this,e)},EJS.Helpers.prototype={list:function(t,e){can.each(t,function(n,r){e(n,r,t)})}},can.view.register({suffix:"ejs",script:function(t,e){return"can.EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:e,name:t}).template.out+" })"},renderer:function(t,e){return EJS({text:e,name:t})}})}(this,jQuery),function(t,e,n){t.view.ext=".mustache";var r="___c0nt3xt",a="___h4sh",i="___st4ck",s=i+"("+r+",this)",c=function(e){return t.isFunction(e.attr)&&e.constructor&&!!e.constructor.canMakeObserve},o=function(t){return t&&t.splice&&"number"==typeof t.length},u=function(e){if(this.constructor!=u){var r=new u(e);return function(t){return r.render(t)}}return"function"==typeof e?(this.template={fn:e},n):(t.extend(this,e),this.template=this.scanner.scan(this.text,this.name),n)};t.Mustache=e.Mustache=u,u.prototype.render=function(t){return t=t||{},this.template.fn.call(t,t,{_data:t})},t.extend(u.prototype,{scanner:new t.view.Scanner({text:{start:"var "+r+" = []; "+r+"."+i+" = true;"+"var "+i+" = function(context, self) {"+"var s;"+"if (arguments.length == 1 && context) {"+"s = !context."+i+" ? [context] : context;"+"} else {"+"s = context && context."+i+" ? context.concat([self]) : "+i+"(context).concat([self]);"+"}"+"return (s."+i+" = true) && s;"+"};"},tokens:[["returnLeft","{{{","{{[{&]"],["commentFull","{{!}}","^[\\s\\t]*{{!.+?}}\\n"],["commentLeft","{{!","(\\n[\\s\\t]*{{!|{{!)"],["escapeFull","{{}}","(^[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}$)",function(t){return{before:/^\n.+?\n$/.test(t)?"\n":"",content:t.match(/\{\{(.+?)\}\}/)[1]||""}}],["escapeLeft","{{"],["returnRight","}}}"],["right","}}"]],helpers:[{name:/^>[\s|\w]\w*/,fn:function(e){var n=t.trim(e.replace(/^>\s?/,""));return"can.view.render('"+n+"', "+s+".pop())"}},{name:/^\s?data\s/,fn:function(t){var e=t.replace(/(^\s?data\s)|(["'])/g,"");return"can.proxy(function(__){can.data(can.$(__),'"+e+"', this.pop()); }, "+s+")"}},{name:/^.*$/,fn:function(e,n){var i=!1,c=[];if(e=t.trim(e),e.length&&(i=e.match(/^([#^/]|else$)/))){switch(i=i[0]){case"#":case"^":c.push(n.insert+"can.view.txt(0,'"+n.tagName+"',"+n.status+",this,function(){ return ");break;case"/":return{raw:'return ___v1ew.join("");}}])}));'}}e=e.substring(1)}if("else"!=i){var o,u,h=[],l=0,d=!1;for((t.trim(e)+" ").replace(/((([^\s]+?=)?('.*?'|".*?"))|.*?)\s/g,function(t,e){h.push(e)}),c.push("can.Mustache.txt("+s+","+(i?'"'+i+'"':"null")+",");o=h[l];l++)l&&c.push(","),l&&(u=o.match(/^(('.*?'|".*?"|[0-9.]+|true|false)|((.+?)=(('.*?'|".*?"|[0-9.]+|true|false)|(.+))))$/))?u[2]?c.push(u[0]):(d||(d=!0,c.push("{"+a+":{")),c.push(u[4],":",u[6]?u[6]:'can.Mustache.get("'+u[5].replace(/"/g,'\\"')+'",'+s+")"),l==h.length-1&&c.push("}}")):c.push('can.Mustache.get("'+o.replace(/"/g,'\\"')+'",'+s+(0==l&&h.length>1?",true":"")+")")}switch(i&&"else"!=i&&c.push(",[{_:function(){"),i){case"#":c.push('return ___v1ew.join("");}},{fn:function('+r+"){var ___v1ew = [];");break;case"else":case"^":c.push('return ___v1ew.join("");}},{inverse:function('+r+"){var ___v1ew = [];");break;default:c.push(");")}return c=c.join(""),i?{raw:c}:c}}]})});for(var h=t.view.Scanner.prototype.helpers,l=0;h.length>l;l++)u.prototype.scanner.helpers.unshift(h[l]);u.txt=function(e,r,s){var c,h,l=Array.prototype.slice.call(arguments,3),d=t.extend.apply(t,[{fn:function(){},inverse:function(){}}].concat(r?l.pop():[])),p=l.length?l:[s],f=!0,_=[];if(r)for(c=0;p.length>c;c++)f=o(p[c])?"#"==r?f&&!!p[c].length:"^"==r?f&&!p[c].length:f:"#"==r?f&&!!p[c]:"^"==r?f&&!p[c]:f;if(h=u.getHelper(s)||t.isFunction(s)&&{fn:s}){var e=e[i]&&e[e.length-1]||e,v={fn:t.proxy(d.fn,e),inverse:t.proxy(d.inverse,e)},g=l[l.length-1];return g&&g[a]&&(v.hash=l.pop()[a]),l.push(v),h.fn.apply(e,l)||""}if(f)switch(r){case"#":if(o(s)){for(c=0;s.length>c;c++)_.push(d.fn.call(s[c]||{},e)||"");return _.join("")}return d.fn.call(s||{},e)||"";case"^":return d.inverse.call(s||{},e)||"";default:return""+(s!==n?s:"")}return""},u.get=function(e,r,a){var i,s,h,l,d,p=e.split("."),f=r[r.length-1],_=r[r.length-2];if(/^\.|this$/.test(e)){if(/^object|undefined$/.test(typeof _)){for(;s=r.pop();)if(s!==n)return s;return""}return _||""}if(!a)for(l=r.length-1;l>=0;l--){if(s=r[l],s!==n)for(d=0;p.length>d;d++){if(s[p[d]]===n){if(c(s)){i=s,h=p[d];break}i=s=n;break}i=s,s=s[h=p[d]]}if(s!==n)return t.isFunction(i[h])?i[h]():c(i)?i.attr(h):(c(s)&&o(s)&&s.attr("length"),s)}return f!==n&&t.isFunction(f[e])?f[e]:(s=u.getHelper(e))?e:""},u.registerHelper=function(t,e){this._helpers.push({name:t,fn:e})},u.getHelper=function(t){for(var e,n=0;e=this._helpers[n];n++)if(e.name==t)return e;return null},u._helpers=[{name:"if",fn:function(t,e){return t?e.fn(this):e.inverse(this)}},{name:"unless",fn:function(t,e){return t?n:e.fn(this)}},{name:"each",fn:function(t,e){if(t&&t.length){for(var n=[],r=0;t.length>r;r++)n.push(e.fn(t[r]));return n.join("")}}},{name:"with",fn:function(t,e){return t?e.fn(t):n}}],t.view.register({suffix:"mustache",contentType:"x-mustache-template",script:function(t,e){return"can.Mustache(function(_CONTEXT,_VIEW) { "+new u({text:e,name:t}).template.out+" })"},renderer:function(t,e){return u({text:e,name:t})}})}(can,this),can.Model("can.Model.LocalStorage",{localStore:function(t){var e=this.name,n=JSON.parse(window.localStorage[e]||(window.localStorage[e]="[]")),r=t.call(this,n);r!==!1&&(can.each(n,function(t){delete t.editing}),window.localStorage[e]=JSON.stringify(n))},findAll:function(){var t=new can.Deferred;return this.localStore(function(e){var n=[],r=this;can.each(e,function(t){n.push(new r(t))}),t.resolve({data:n})}),t},destroy:function(t){var e=new can.Deferred;return this.localStore(function(n){for(var r=0;n.length>r;r++)if(n[r].id===t){n.splice(r,1);break}e.resolve({})}),e},create:function(t){var e=new can.Deferred;return this.localStore(function(e){t.id=t.id||parseInt(1e5*Math.random(),10),e.push(t)}),e.resolve({id:t.id}),e},update:function(t,e){var n,r=new can.Deferred;return this.localStore(function(r){for(var a=0;r.length>a;a++)if(r[a].id===t){n=r[a];break}can.extend(n,e)}),r.resolve({}),r}},{}),function(t){"use strict";var e=can.Model.LocalStorage({storageName:"todos-canjs"},{matches:function(){var t=can.route.attr("filter");return!t||"active"===t&&!this.attr("complete")||"completed"===t&&this.attr("complete")}});e.List=can.Model.List({completed:function(){var t=0;return this.each(function(e){t+=e.attr("complete")?1:0}),t},remaining:function(){return this.attr("length")-this.completed()},allComplete:function(){return this.attr("length")===this.completed()}}),t.Models=t.Models||{},t.Models.Todo=e}(this),function(t){"use strict";var e=13,n=can.Control({defaults:{view:"views/todos.ejs"}},{init:function(){this.element.append(can.view(this.options.view,this.options))},"#new-todo keyup":function(t,n){var r=can.trim(t.val());n.keyCode===e&&""!==r&&new Models.Todo({text:r,complete:!1}).save(function(){t.val("")})},"{Models.Todo} created":function(t,e,n){this.options.todos.push(n),this.options.state.attr("filter","")},"{state} change":function(){this.element.find("#filters").find("a").removeClass("selected").end().find('[href="'+window.location.hash+'"]').addClass("selected")},".todo dblclick":function(t){t.data("todo").attr("editing",!0).save(function(){t.children(".edit").focus()})},updateTodo:function(t){var e=can.trim(t.val()),n=t.closest(".todo").data("todo");n&&(""===e?n.destroy():n.attr({editing:!1,text:e}).save())},".todo .edit keyup":function(t,n){n.keyCode===e&&this.updateTodo(t)},".todo .edit focusout":"updateTodo",".todo .toggle click":function(t){t.closest(".todo").data("todo").attr("complete",t.is(":checked")).save()},".todo .destroy click":function(t){t.closest(".todo").data("todo").destroy()},"#toggle-all click":function(t){var e=t.prop("checked");can.each(this.options.todos,function(t){t.attr("complete",e).save()})},"#clear-completed click":function(){for(var t,e=this.options.todos.length-1;e>-1&&(t=this.options.todos[e]);e--)t.attr("complete")&&t.destroy()}});t.Todos=n}(this),function(){$(function(){$("body").append(can.view("views/app.ejs",{})),can.route(":filter"),can.route.ready(!1),Mustache.registerHelper("plural",function(t,e){return t+(1!==e?"s":"")}),Models.Todo.findAll({},function(t){new Todos("#todoapp",{todos:t,state:can.route,view:"views/todos.mustache"})}),can.route.ready(!0)})}(),function(window){can.view.preload("views_app_ejs",can.EJS(function(_CONTEXT,_VIEW){with(_VIEW)with(_CONTEXT){var ___v1ew=[];return ___v1ew.push('<section id="todoapp">\n</section>\n<div id="info">\n  <p>Double-click to edit a todo</p>\n  <p>Written by <a href="http://bitovi.com">Bitovi</a></p>\n  <p>Part of <a href="http://todomvc.com">TodoMVC</a></p>\n</div>'),___v1ew.join("")}})),can.view.preload("views_todos_mustache",can.Mustache(function(_CONTEXT,_VIEW){with(_VIEW)with(_CONTEXT){var ___v1ew=[],___c0nt3xt=[];___c0nt3xt.___st4ck=!0;var ___st4ck=function(t,e){var n;return n=1==arguments.length&&t?t.___st4ck?t:[t]:t&&t.___st4ck?t.concat([e]):___st4ck(t).concat([e]),(n.___st4ck=!0)&&n};return ___v1ew.push('<header id="header">\n  <h1>todos</h1>\n  <input id="new-todo" '),___v1ew.push(can.view.txt(1,"input",1,this,function(){return function(t){var e=can.$(t);e.val("").focus()}})),___v1ew.push(' placeholder="What needs to be done?" autofocus=""',can.view.pending(),">"),___v1ew.push('\n</header>\n<section id="main" class="'),___v1ew.push(can.view.txt(0,"section","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push('\n  <input id="toggle-all" type="checkbox" '),___v1ew.push(can.view.txt(0,"input",1,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"#",can.Mustache.get("todos.allComplete",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{fn:function(){var t=[];return t.push('checked="checked"'),t.join("")}}])})),___v1ew.push("",can.view.pending(),">"),___v1ew.push('\n  <label for="toggle-all" >Mark all as complete</label>\n  <ul id="todo-list">'),___v1ew.push("\n"),___v1ew.push(can.view.txt(0,"ul",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"#",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{fn:function(t){var e=[];return e.push('    <li class="todo '),e.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(t,this),"^",can.Mustache.get("matches",___st4ck(t,this)),[{_:function(){return e.join("")}},{inverse:function(){var t=[];return t.push("hidden"),t.join("")}}])})),e.push(" "),e.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(t,this),"#",can.Mustache.get("complete",___st4ck(t,this)),[{_:function(){return e.join("")}},{fn:function(){var t=[];return t.push("completed"),t.join("")}}])})),e.push(" "),e.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(t,this),"#",can.Mustache.get("editing",___st4ck(t,this)),[{_:function(){return e.join("")}},{fn:function(){var t=[];return t.push("editing"),t.join("")}}])})),e.push('" '),e.push(can.view.txt(1,"li",1,this,function(){return can.proxy(function(t){can.data(can.$(t),"todo",this.pop())},___st4ck(t,this))})),e.push("",can.view.pending(),">"),e.push('\n    <div class="view">\n      <input class="toggle" type="checkbox" '),e.push(can.view.txt(0,"input",1,this,function(){return can.Mustache.txt(___st4ck(t,this),"#",can.Mustache.get("complete",___st4ck(t,this)),[{_:function(){return e.join("")}},{fn:function(){var t=[];return t.push('checked="checked"'),t.join("")}}])})),e.push("",can.view.pending(),">"),e.push("\n      <label>"),e.push(can.view.txt(1,"label",0,this,function(){return can.Mustache.txt(___st4ck(t,this),null,can.Mustache.get("text",___st4ck(t,this)))})),e.push('</label>\n      <button class="destroy"></button>\n    </div>\n    <input class="edit" type="text" value="'),e.push(can.view.txt(1,"input","value",this,function(){return can.Mustache.txt(___st4ck(t,this),null,can.Mustache.get("text",___st4ck(t,this)))})),e.push('"',can.view.pending(),">"),e.push("\n    </li>"),e.push("\n"),e.join("")}}])})),___v1ew.push('  </ul>\n</section>\n<footer id="footer" class="'),___v1ew.push(can.view.txt(0,"footer","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push('\n  <span id="todo-count">\n    <strong>'),___v1ew.push(can.view.txt(1,"strong",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("todos.remaining",___st4ck(___c0nt3xt,this)))})),___v1ew.push("</strong> "),___v1ew.push(can.view.txt(1,"span",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("plural",___st4ck(___c0nt3xt,this),!0),"item",can.Mustache.get("todos.remaining",___st4ck(___c0nt3xt,this)))})),___v1ew.push(' left\n  </span>\n  <ul id="filters">\n    <li>\n      <a class="selected" href="#!">All</a>\n    </li>\n    <li>\n      <a href="#!active">Active</a>\n    </li>\n    <li>\n      <a href="#!completed">Completed</a>\n    </li>\n  </ul>\n  <a href="#!" id="clear-completed" class="'),___v1ew.push(can.view.txt(0,"a","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push("\n    Clear "),___v1ew.push(can.view.txt(1,"a",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)))})),___v1ew.push(" completed "),___v1ew.push(can.view.txt(1,"a",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("plural",___st4ck(___c0nt3xt,this),!0),"item",can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)))})),___v1ew.push("\n  </a>\n</footer>"),___v1ew.join("")}}))}(this);